# 사용자 역할 가이드

## 역할별 권한 비교표

| 기능 | 관리자 (admin) | 매니저 (manager) | 스태프 (staff) | 조회자 (viewer) |
|------|---------------|-----------------|---------------|----------------|
| **데이터 조회** |
| 웹툰/회차/컷 조회 | ✅ | ✅ | ✅ | ✅ |
| 파일 조회 | ✅ | ✅ | ✅ | ✅ |
| 검색 | ✅ | ✅ | ✅ | ✅ |
| **콘텐츠 관리** |
| 웹툰 생성/수정/삭제 | ✅ | ✅ | ❌ | ❌ |
| 회차 생성/수정/삭제 | ✅ | ✅ | ❌ | ❌ |
| 컷 생성/수정/삭제 | ✅ | ✅ | ❌ | ❌ |
| **파일 관리** |
| 파일 업로드 | ✅ | ✅ | ✅ | ❌ |
| 파일 다운로드 | ✅ | ✅ | ✅ | ✅ |
| 파일 삭제 | ✅ (모든 파일) | ✅ (모든 파일) | ✅ (본인 파일만) | ❌ |
| **공정 관리** |
| 공정 생성/수정/삭제 | ✅ | ✅ | ❌ | ❌ |
| 공정 순서 변경 | ✅ | ✅ | ❌ | ❌ |
| **사용자 관리** |
| 사용자 초대 | ✅ | ❌ | ❌ | ❌ |
| 사용자 권한 변경 | ✅ | ❌ | ❌ | ❌ |
| 사용자 삭제 | ✅ | ❌ | ❌ | ❌ |
| 관리자 페이지 접근 | ✅ | ❌ | ❌ | ❌ |

## 역할별 상세 설명

### 1. 관리자 (admin) 👑

**가장 높은 권한을 가진 역할**

- ✅ **모든 기능 접근 가능**
- ✅ **사용자 관리**: 다른 사용자 초대, 권한 변경, 삭제
- ✅ **시스템 관리**: 관리자 페이지 접근, 초대 관리
- ✅ **콘텐츠 관리**: 웹툰/회차/컷 생성/수정/삭제
- ✅ **파일 관리**: 모든 파일 업로드/다운로드/삭제
- ✅ **공정 관리**: 공정 생성/수정/삭제/순서 변경

**사용 사례**: 
- 프로젝트 총괄 관리자
- 시스템 관리자
- 최종 승인 권한이 필요한 사용자

---

### 2. 매니저 (manager) 📋

**콘텐츠와 파일을 관리하는 역할**

- ✅ **콘텐츠 관리**: 웹툰/회차/컷 생성/수정/삭제
- ✅ **파일 관리**: 모든 파일 업로드/다운로드/삭제
- ✅ **공정 관리**: 공정 생성/수정/삭제/순서 변경
- ❌ **사용자 관리 불가**: 초대, 권한 변경 불가
- ❌ **관리자 페이지 접근 불가**

**사용 사례**:
- 작가
- 편집자
- 프로젝트 매니저
- 콘텐츠 제작 책임자

---

### 3. 스태프 (staff) ✏️

**파일 업로드와 작업에 집중하는 역할**

- ✅ **데이터 조회**: 모든 웹툰/회차/컷/파일 조회
- ✅ **파일 업로드**: 작업 파일 업로드 가능
- ✅ **파일 다운로드**: 필요한 파일 다운로드 가능
- ✅ **본인 파일 삭제**: 자신이 업로드한 파일만 삭제 가능
- ❌ **콘텐츠 생성/수정/삭제 불가**: 웹툰/회차/컷 관리 불가
- ❌ **공정 관리 불가**
- ❌ **사용자 관리 불가**

**사용 사례**:
- 채색 담당자
- 선화 담당자
- 콘티 담당자
- 작업 파일을 업로드하는 스태프

---

### 4. 조회자 (viewer) 👁️

**조회만 가능한 읽기 전용 역할**

- ✅ **데이터 조회**: 모든 웹툰/회차/컷/파일 조회
- ✅ **파일 다운로드**: 필요한 파일 다운로드 가능
- ✅ **검색**: 파일 검색 가능
- ❌ **생성/수정/삭제 불가**: 모든 생성/수정/삭제 기능 불가
- ❌ **파일 업로드 불가**
- ❌ **공정 관리 불가**
- ❌ **사용자 관리 불가**

**사용 사례**:
- 클라이언트
- 검토자
- 감독
- 진행 상황만 확인이 필요한 사용자

---

## 권한 체크 사용 예시

코드에서 권한을 체크하려면 `lib/utils/permissions.ts`의 유틸리티 함수를 사용하세요:

```typescript
import { canCreateContent, canUploadFile, canDeleteFile } from '@/lib/utils/permissions';
import { useStore } from '@/lib/store/useStore';

function MyComponent() {
  const { profile } = useStore();
  
  // 웹툰 생성 버튼 표시 여부
  const showCreateButton = profile && canCreateContent(profile.role);
  
  // 파일 업로드 가능 여부
  const canUpload = profile && canUploadFile(profile.role);
  
  // 파일 삭제 가능 여부 (본인 파일인지 확인)
  const canDelete = profile && canDeleteFile(
    profile.role, 
    file.uploaded_by, 
    profile.id
  );
  
  return (
    <>
      {showCreateButton && <Button>웹툰 생성</Button>}
      {canUpload && <FileUploadButton />}
      {canDelete && <DeleteButton />}
    </>
  );
}
```

---

## 역할 변경

현재는 관리자만 역할을 변경할 수 있습니다. 향후 관리자 페이지에서 사용자 역할 변경 기능이 추가될 예정입니다.

---

## 보안 주의사항

⚠️ **중요**: 현재 UI 레벨에서만 권한 체크가 이루어지고 있습니다. 
프로덕션 배포 전에는 반드시 **Row Level Security (RLS) 정책**을 데이터베이스 레벨에서 설정해야 합니다.


